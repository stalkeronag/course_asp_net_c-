# Развертывание приложения

[Docker](https://www.docker.com/) - это открытое программное обеспечение, которое позволяет разрабатывать,
упаковывать и запускать приложения в изолированных контейнерах. Это означает, что каждое приложение может быть запущено
в своей собственной виртуальной среде, которая имеет свои собственные зависимости и настройки, отличные от других
приложений, запущенных на том же сервере.

Docker отличается от других инструментов виртуализации тем, что он использует контейнеры вместо виртуальных машин.
Виртуальные машины требуют гипервизора, который виртуализирует аппаратное обеспечение и создает полную виртуальную среду
с собственной операционной системой, драйверами и приложениями. В отличие от этого, контейнеры Docker используют общую
операционную систему хост-машины и предоставляют среду, которая изолирует приложения друг от друга, но не требует
полного виртуального окружения. Docker стал так популярен благодаря своим преимуществам, таким как:

- Портативность: Docker обеспечивает портативность приложений, позволяя разработчикам создавать приложения в
  контейнерах, которые могут работать на любой машине, поддерживающей Docker. Это упрощает развертывание приложений и
  позволяет разработчикам быстро переносить их между различными средами.
- Изоляция: Docker использует контейнеры, которые обеспечивают изоляцию приложений друг от друга и от хост-системы. Это
  позволяет разработчикам использовать различные версии языков, библиотек и другого ПО, без взаимных конфликтов.
- Масштабируемость: Docker обеспечивает простой способ масштабирования приложений, позволяя запускать несколько
  экземпляров контейнеров для обработки высокой нагрузки. Это позволяет разработчикам улучшать производительность
  приложений и обеспечивать их доступность в любое время.
- Управление зависимостями: Docker облегчает управление зависимостями приложения, позволяя разработчикам устанавливать и
  настраивать необходимое ПО в контейнерах. Это упрощает установку и настройку ПО и позволяет быстро создавать среды для
  разработки.
- Отладка: Docker позволяет легко отлаживать приложения, позволяя разработчикам запускать их в контейнерах и
  изолированных средах. Это упрощает поиск ошибок и улучшает качество кода.
- Совместная разработка: Docker обеспечивает возможность совместной разработки, позволяя нескольким разработчикам
  работать над одним проектом и использовать общие контейнеры и настройки. Это улучшает производительность команды и
  ускоряет процесс разработки.
- Быстрое развертывание: Docker позволяет разработчикам быстро создавать и развертывать приложения, что ускоряет процесс
  разработки и доставки приложений. Docker также предоставляет большое количество готовых образов с предустановленными
  зависимостями, которые позволяют разработчикам

### Процесс разработки с Docker

Совместный процесс разработки с использованием Docker может выглядеть следующим образом:

- Разработчики создают файл docker-compose.yml, который описывает структуру приложения и его зависимости.
- Каждый разработчик клонирует репозиторий с исходным кодом приложения на свой локальный компьютер.
- Разработчики запускают приложение в контейнерах с помощью команды "docker-compose up". Это создаст контейнеры для
  каждой службы приложения, которые будут работать вместе.
- Разработчики могут вносить изменения в исходный код приложения, используя свои любимые редакторы кода.
- Когда разработчики завершают свою работу, они сохраняют изменения в репозиторий и отправляют их на сервер.
- Сервер автоматически запускает тестирование и развертывание приложения в контейнерах с помощью docker-compose.
- Если тестирование проходит успешно, сервер развертывает обновленную версию приложения.

Такой процесс позволяет разработчикам работать над приложением независимо друг от друга, используя общие контейнеры и
настройки, которые гарантируют одинаковую среду для всех участников проекта. Docker упрощает управление и
развертывание приложения, позволяя быстро создавать, изменять и тестировать контейнеры, что повышает скорость и качество
разработки.

## Практика

- Установите Docker.
- Запустите проект в докере с помощью команды `docker compose up`. Файл `docker-compose.yml` уже есть в репозитории.
- Обратите внимание, что при запуске в Docker используется окружение `Production`, таким образом теперь наше приложение
  работает в трёх окружениях:
    - Development - при запуске из IDE; использует локальную БД PostgreSQL
    - Test - при запуске интеграционных тестов; использует in-memory провайдер
    - Production - при запуске в Docker; использует БД PostgreSQL в отдельном контейнере.
- Добавьте в файл `docker-compose.yml` строку подключения к базе данных следующим способом:
<br />`environment:`<br />
  &ensp;&thinsp;&ensp;&thinsp;&ensp;&thinsp;`ConnectionStrings: Default: "Your connection string"`

- Всегда убеждайтесь, что приложение работает в контейнере через `docker compose up`

## Теория

- [Get Started with Docker](https://www.docker.com/get-started/)
- [Docker начало](https://habr.com/ru/post/353238/)
- [Образы Docker для ASP.NET Core](https://learn.microsoft.com/ru-ru/aspnet/core/host-and-deploy/docker/building-net-docker-images?view=aspnetcore-7.0)
- [Руководство по Docker Compose для начинающих](https://habr.com/ru/company/ruvds/blog/450312/)
